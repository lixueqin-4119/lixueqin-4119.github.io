<!DOCTYPE html>
<html
  lang="en"
  dir="ltr"
  
><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">


<title>AJAX 的原理 | 目录 | 博客</title>

<meta name="generator" content="Hugo Eureka 0.9.1" />
<link rel="stylesheet" href="http://lixueqin-4119.xyz/css/eureka.min.6a378a23360d238dc3ef4df2f5cd718093f02c10c9c7eb2437c29701cd8d389ab6da5d9f21bdd3afa305fd56c1235017.css" integrity="sha384-ajeKIzYNI43D703y9c1xgJPwLBDJx&#43;skN8KXAc2NOJq22l2fIb3Tr6MF/VbBI1AX">
<script defer src="http://lixueqin-4119.xyz/js/eureka.min.f1639ee98d6cbd85b2b5f034d27320da962002ff83159ed4e01dbc5948c42a1ab26c2d6e74c66e93f5cec4d24dbd166d.js" integrity="sha384-8WOe6Y1svYWytfA00nMg2pYgAv&#43;DFZ7U4B28WUjEKhqybC1udMZuk/XOxNJNvRZt"></script>

<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload"
  href="https://fonts.googleapis.com/css2?family=Lora:wght@400;600;700&family=Noto+Serif+SC:wght@400;600;700&display=swap"
  as="style" onload="this.onload=null;this.rel='stylesheet'">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/styles/base16/solarized-light.min.css"
   media="print"
  onload="this.media='all';this.onload=null" crossorigin>
<script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/highlight.min.js"
   crossorigin></script>
  <script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/dart.min.js"
     crossorigin></script>


<script defer type="text/javascript" src="http://lixueqin-4119.xyz/js/fontawesome.min.7b735802cbde01152678cc4a867f0b4bb0597876e29adfcaf1e5b5e99d39d7af87f348fdfd91c7eaf9ed7dc1eece7c61.js" integrity="sha384-e3NYAsveARUmeMxKhn8LS7BZeHbimt/K8eW16Z0516&#43;H80j9/ZHH6vntfcHuznxh"></script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css"
   integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ"  media="print"
  onload="this.media='all';this.onload=null" crossorigin>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js" 
  integrity="sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY"  crossorigin></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js"
   integrity="sha384-&#43;XBljXPPiv&#43;OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR"  crossorigin></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false },
        { left: "\\(", right: "\\)", display: false },
        { left: "\\[", right: "\\]", display: true }
      ],
    });
  });
</script>


<script defer src="https://cdn.jsdelivr.net/npm/mermaid@8.14.0/dist/mermaid.min.js" 
  integrity="sha384-atOyb0FxAgN9LyAc6PEf9BjgwLISyansgdH8/VXQH8p2o5vfrRgmGIJ2Sg22L0A0"  crossorigin></script>


<link rel="icon" type="image/png" sizes="32x32" href="http://lixueqin-4119.xyz/images/icon_hu64421c6c7700f606f0ad45d807017b09_5843_32x32_fill_box_center_3.png">
<link rel="apple-touch-icon" sizes="180x180" href="http://lixueqin-4119.xyz/images/icon_hu64421c6c7700f606f0ad45d807017b09_5843_180x180_fill_box_center_3.png">

<meta name="description"
  content="js三座大山之Ajax
Ajax的全部内容: 用js控制浏览器发请求和收响应
 背景(原理)
1.Ajax是浏览器推出的一个功能
浏览器可以发请求，收响应
浏览器在window上加了一个XMLHttpRequest全局函数
用这个构造函数(类)可以构造出一个对象
JS通过它实现发请求，收响应
typeof window.XMLHttpRequest &#39;function&#39;  实际上跟window.Object是一样的。
window.Object用来创建普通对象，window.XMLHttpRequest用来创建XMLRequest对象。
XMLHttpRequest也是一个构造函数，可以构造出一个对象。
2.准备一个服务器，用来接收请求
使用server.js作为我们的服务器
启动node server.js 8888
添加index.html/main.js两个路由
工具 node-dev 是一个node.js开发工具，当文件被修改时会自动重启node进程。
Installation安装:yarn global add node-dev Usage使用: node-dev src/server.js  用node-dev代替node方便开发，node-dev修改时会自动保存重启Restarting
node-dev 已经出 bug 没人修理了，不要使用，请直接使用 node 并手动重启。
添加index.html/main.js两个路由
http://localhost:8888/index.html 注意浏览器路径要一致！ if (path === &#39;/index.html&#39;) { //1.添加index.html response.statusCode = 200 response.setHeader(&#39;Content-Type&#39;, &#39;text/html;charset=utf-8&#39;) response.write(`\n &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;title&gt;Ajax&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Ajax demo&lt;/h1&gt; &lt;script src=&quot;main.js&quot;&gt;&lt;/script&gt; &lt;/body&gt; &lt;/html&gt; `) response.end() } else if (path === &#39;/main.">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
      "@type": "ListItem",
      "position": 1 ,
      "name":"",
      "item":"http://lixueqin-4119.xyz/docs/"},{
      "@type": "ListItem",
      "position": 2 ,
      "name":"目录",
      "item":"http://lixueqin-4119.xyz/docs/example-doc/"},{
      "@type": "ListItem",
      "position": 3 ,
      "name":"前后分离",
      "item":"http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/"},{
      "@type": "ListItem",
      "position": 4 ,
      "name":"AJAX 的原理",
      "item":"http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/ajax-%E7%9A%84%E5%8E%9F%E7%90%86/"}]
}
</script>



<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/ajax-%E7%9A%84%E5%8E%9F%E7%90%86/"
    },
    "headline": "AJAX 的原理 | 目录 | 博客","datePublished": "2020-10-16T00:00:00+00:00",
    "dateModified": "2020-10-16T00:00:00+00:00",
    "wordCount":  882 ,
    "publisher": {
        "@type": "Person",
        "name": "WANG Chucheng",
        "logo": {
            "@type": "ImageObject",
            "url": "http://lixueqin-4119.xyz/images/icon.png"
        }
        },
    "description": "js三座大山之Ajax\nAjax的全部内容: 用js控制浏览器发请求和收响应\n 背景(原理)\n1.Ajax是浏览器推出的一个功能\n浏览器可以发请求，收响应\n浏览器在window上加了一个XMLHttpRequest全局函数\n用这个构造函数(类)可以构造出一个对象\nJS通过它实现发请求，收响应\ntypeof window.XMLHttpRequest \u0027function\u0027  实际上跟window.Object是一样的。\nwindow.Object用来创建普通对象，window.XMLHttpRequest用来创建XMLRequest对象。\nXMLHttpRequest也是一个构造函数，可以构造出一个对象。\n2.准备一个服务器，用来接收请求\n使用server.js作为我们的服务器\n启动node server.js 8888\n添加index.html\/main.js两个路由\n工具 node-dev 是一个node.js开发工具，当文件被修改时会自动重启node进程。\nInstallation安装:yarn global add node-dev Usage使用: node-dev src\/server.js  用node-dev代替node方便开发，node-dev修改时会自动保存重启Restarting\nnode-dev 已经出 bug 没人修理了，不要使用，请直接使用 node 并手动重启。\n添加index.html\/main.js两个路由\nhttp:\/\/localhost:8888\/index.html 注意浏览器路径要一致！ if (path === \u0027\/index.html\u0027) { \/\/1.添加index.html response.statusCode = 200 response.setHeader(\u0027Content-Type\u0027, \u0027text\/html;charset=utf-8\u0027) response.write(`\\n \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;Ajax\u0026lt;\/title\u0026gt; \u0026lt;\/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;Ajax demo\u0026lt;\/h1\u0026gt; \u0026lt;script src=\u0026quot;main.js\u0026quot;\u0026gt;\u0026lt;\/script\u0026gt; \u0026lt;\/body\u0026gt; \u0026lt;\/html\u0026gt; `) response.end() } else if (path === \u0027\/main."
}
</script><meta property="og:title" content="AJAX 的原理 | 目录 | 博客" />
<meta property="og:type" content="article" />


<meta property="og:image" content="http://lixueqin-4119.xyz/images/icon.png">


<meta property="og:url" content="http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/ajax-%E7%9A%84%E5%8E%9F%E7%90%86/" />




<meta property="og:description" content="js三座大山之Ajax
Ajax的全部内容: 用js控制浏览器发请求和收响应
 背景(原理)
1.Ajax是浏览器推出的一个功能
浏览器可以发请求，收响应
浏览器在window上加了一个XMLHttpRequest全局函数
用这个构造函数(类)可以构造出一个对象
JS通过它实现发请求，收响应
typeof window.XMLHttpRequest &#39;function&#39;  实际上跟window.Object是一样的。
window.Object用来创建普通对象，window.XMLHttpRequest用来创建XMLRequest对象。
XMLHttpRequest也是一个构造函数，可以构造出一个对象。
2.准备一个服务器，用来接收请求
使用server.js作为我们的服务器
启动node server.js 8888
添加index.html/main.js两个路由
工具 node-dev 是一个node.js开发工具，当文件被修改时会自动重启node进程。
Installation安装:yarn global add node-dev Usage使用: node-dev src/server.js  用node-dev代替node方便开发，node-dev修改时会自动保存重启Restarting
node-dev 已经出 bug 没人修理了，不要使用，请直接使用 node 并手动重启。
添加index.html/main.js两个路由
http://localhost:8888/index.html 注意浏览器路径要一致！ if (path === &#39;/index.html&#39;) { //1.添加index.html response.statusCode = 200 response.setHeader(&#39;Content-Type&#39;, &#39;text/html;charset=utf-8&#39;) response.write(`\n &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;title&gt;Ajax&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Ajax demo&lt;/h1&gt; &lt;script src=&quot;main.js&quot;&gt;&lt;/script&gt; &lt;/body&gt; &lt;/html&gt; `) response.end() } else if (path === &#39;/main." />




<meta property="og:locale" content="en" />




<meta property="og:site_name" content="博客" />






<meta property="article:published_time" content="2020-10-16T00:00:00&#43;00:00" />


<meta property="article:modified_time" content="2020-10-16T00:00:00&#43;00:00" />



<meta property="article:section" content="docs" />





  <body class="flex min-h-screen flex-col">
    <header
      class="min-h-16 pl-scrollbar bg-secondary-bg fixed z-50 flex w-full items-center shadow-sm"
    >
      <div class="mx-auto w-full max-w-screen-xl"><script>
    let storageColorScheme = localStorage.getItem("lightDarkMode")
    if (((storageColorScheme == 'Auto' || storageColorScheme == null) && window.matchMedia("(prefers-color-scheme: dark)").matches) || storageColorScheme == "Dark") {
        document.getElementsByTagName('html')[0].classList.add('dark')
    }
</script>
<nav class="flex items-center justify-between flex-wrap px-4 py-4 md:py-0">
    <a href="/" class="me-6 text-primary-text text-xl font-bold">博客</a>
    <button id="navbar-btn" class="md:hidden flex items-center px-3 py-2" aria-label="Open Navbar">
        <i class="fas fa-bars"></i>
    </button>

    <div id="target"
        class="hidden block md:flex md:grow md:justify-between md:items-center w-full md:w-auto text-primary-text z-20">
        <div class="md:flex md:h-16 text-sm md:grow pb-4 md:pb-0 border-b md:border-b-0">
            <a href="/posts/" class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2  border-transparent  me-4">简介</a>
            <a href="/docs/" class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2  selected-menu-item  me-4">文章</a>
            <a href="/#about" class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2  border-transparent  me-4">关于我</a>
        </div>

        <div class="flex">
            <div class="relative pt-4 md:pt-0">
                <div class="cursor-pointer hover:text-eureka" id="lightDarkMode">
                    <i class="fas fa-adjust"></i>
                </div>
                <div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-30" id="is-open">
                </div>
                <div class="absolute flex flex-col start-0 md:start-auto end-auto md:end-0 hidden bg-secondary-bg w-48 rounded py-2 border border-tertiary-bg cursor-pointer z-40"
                    id='lightDarkOptions'>
                    <span class="px-4 py-1 hover:text-eureka" name="Light">Light</span>
                    <span class="px-4 py-1 hover:text-eureka" name="Dark">Dark</span>
                    <span class="px-4 py-1 hover:text-eureka" name="Auto">Auto</span>
                </div>
            </div>
        </div>
    </div>

    <div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-0" id="is-open-mobile">
    </div>

</nav>
<script>
    
    let element = document.getElementById('lightDarkMode')
    if (storageColorScheme == null || storageColorScheme == 'Auto') {
        document.addEventListener('DOMContentLoaded', () => {
            window.matchMedia("(prefers-color-scheme: dark)").addEventListener('change', switchDarkMode)
        })
    } else if (storageColorScheme == "Light") {
        element.firstElementChild.classList.remove('fa-adjust')
        element.firstElementChild.setAttribute("data-icon", 'sun')
        element.firstElementChild.classList.add('fa-sun')
    } else if (storageColorScheme == "Dark") {
        element.firstElementChild.classList.remove('fa-adjust')
        element.firstElementChild.setAttribute("data-icon", 'moon')
        element.firstElementChild.classList.add('fa-moon')
    }

    document.addEventListener('DOMContentLoaded', () => {
        getcolorscheme();
        switchBurger();
    });
</script>
</div>
    </header>
    <main class="grow pt-16">
        <div class="pl-scrollbar">
          <div class="mx-auto w-full max-w-screen-xl lg:px-4 xl:px-8">


<div class="lg:pt-12">
    <div class="flex flex-col md:flex-row bg-secondary-bg rounded">
        <div class="md:w-1/4 lg:w-1/5 border-e">
            <div class="sticky top-16 pt-6">
                















<div id="sidebar-title" class="md:hidden mx-4 px-2 pt-4 pb-2 md:border-b text-tertiary-text md:text-primary-text">
    <span class="font-semibold">Table of Contents</span>
    <i class='fas fa-caret-right ms-1'></i>
</div>

<div id="sidebar-toc"
    class="hidden md:block overflow-y-auto mx-6 md:mx-0 pe-6 pt-2 md:max-h-doc-sidebar bg-primary-bg md:bg-transparent">
    <div class="flex flex-wrap ms-4 -me-2 p-2 bg-secondary-bg md:bg-primary-bg rounded">
        <a class=" hover:text-eureka"
            href="http://lixueqin-4119.xyz/docs/example-doc/">目录</a>
        
        
        


    </div>
    
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/nested-chapter/">【Git入门】</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/nested-chapter/%E7%94%A8hugo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/">用hugo搭建个人博客</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/nested-chapter/git%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93-github-/">Git远程仓库 -GitHub</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/nested-chapter/%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%85%A5%E9%97%A8/">命令行入门</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/nested-chapter/%E6%9C%AC%E5%9C%B0%E4%BB%93%E5%BA%93/">本地仓库</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/html%E5%85%A8%E8%A7%A3/">【HTML全解】</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/html%E5%85%A8%E8%A7%A3/html%E6%A0%87%E7%AD%BE/">HTML标签</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/html%E5%85%A8%E8%A7%A3/html%E6%A6%82%E8%A7%88/">HTML概览</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/html%E5%85%A8%E8%A7%A3/html%E9%87%8D%E7%82%B9%E6%A0%87%E7%AD%BE/">HTML重点标签</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/html%E5%85%A8%E8%A7%A3/%E6%89%8B%E6%9C%BA%E9%A2%84%E8%A7%88-%E8%B0%83%E8%AF%95/">手机预览 &amp; 调试</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/css%E5%85%A8%E8%A7%A3/">CSS全解</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/css%E5%85%A8%E8%A7%A3/css%E5%8A%A8%E7%94%BB/">css动画</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/css%E5%85%A8%E8%A7%A3/css%E5%9F%BA%E7%A1%80/">css基础</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/css%E5%85%A8%E8%A7%A3/css%E5%AE%9A%E4%BD%8D/">css定位</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/css%E5%85%A8%E8%A7%A3/css%E5%B8%83%E5%B1%80/">css布局</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/http%E5%85%A8%E8%A7%A3/">HTTP全解</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/http%E5%85%A8%E8%A7%A3/http-%E7%8A%B6%E6%80%81%E7%A0%81/">HTTP 状态码</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/http%E5%85%A8%E8%A7%A3/url-%E6%98%AF%E4%BB%80%E4%B9%88/">URL 是什么</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/http%E5%85%A8%E8%A7%A3/%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94-node.js-server/">请求和响应 &amp; Node.js Server</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/">JS全解</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/javascript-%E7%9A%84%E8%AF%9E%E7%94%9F/">JavaScript 的诞生</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/js%E5%87%BD%E6%95%B0/">JS函数</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/js%E5%AF%B9%E8%B1%A1/">JS对象</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/js%E5%AF%B9%E8%B1%A1%E5%88%86%E7%B1%BB/">JS对象分类</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/js%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/">JS数据类型</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/js%E6%95%B0%E7%BB%84/">JS数组</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/js%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">JS正则表达式</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/js%E8%8E%B7%E5%8F%96%E5%B1%8F%E5%B9%95%E5%AE%BD%E9%AB%98/">js获取屏幕宽高</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/js%E8%AF%AD%E6%B3%95/">JS语法</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/js%E8%BF%90%E7%AE%97%E7%AC%A6/">JS运算符</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E7%BC%96%E7%A8%8B%E6%8E%A5%E5%8F%A3/">JS编程接口</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E7%BC%96%E7%A8%8B%E6%8E%A5%E5%8F%A3/dom-%E7%BC%96%E7%A8%8B/">DOM 编程</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E7%BC%96%E7%A8%8B%E6%8E%A5%E5%8F%A3/dom%E4%BA%8B%E4%BB%B6%E4%B8%8E%E4%BA%8B%E4%BB%B6%E5%A7%94%E6%89%98/">DOM事件与事件委托</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E7%BC%96%E7%A8%8B%E6%8E%A5%E5%8F%A3/-jquery-%E4%B8%AD%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8A/">jQuery 中的设计模式(上)</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E7%BC%96%E7%A8%8B%E6%8E%A5%E5%8F%A3/jquery-%E4%B8%AD%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8B/">jQuery 中的设计模式(下)</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E7%BC%96%E7%A8%8B%E6%8E%A5%E5%8F%A3/%E6%89%8B%E5%86%99dom%E5%BA%931/">手写DOM库(1)</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E8%BF%9B%E9%98%B6/">JS进阶</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E8%BF%9B%E9%98%B6/mvc%E4%B8%8A/">MVC(上)</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E8%BF%9B%E9%98%B6/-mvc%E4%B8%8B-/">MVC(下)</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/react-%E5%85%A8%E8%A7%A3/">React全解</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/react-%E5%85%A8%E8%A7%A3/class-%E7%BB%84%E4%BB%B6%E8%AF%A6%E8%A7%A3/">Class 组件详解</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/react-%E5%85%A8%E8%A7%A3/hooks-%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90/">Hooks 原理解析</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/react-%E5%85%A8%E8%A7%A3/hooks-%E5%90%84%E4%B8%AA%E5%87%BB%E7%A0%B4/">Hooks 各个击破</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/react-%E5%85%A8%E8%A7%A3/react-%E7%B1%BB%E7%BB%84%E4%BB%B6%E5%92%8C%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6/">React 类组件和函数组件</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/react-%E5%85%A8%E8%A7%A3/react%E8%B5%B7%E6%89%8B%E5%BC%8F/">React起手式</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/react-%E5%85%A8%E8%A7%A3/%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6/">函数组件</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/react-%E5%85%A8%E8%A7%A3/%E6%89%8B%E5%86%99-redux/">手写 Redux</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/vue2-%E5%85%A8%E8%A7%A3/">Vue2 全解</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/vue2-%E5%85%A8%E8%A7%A3/computed-%E5%92%8C-watch/">computed 和 watch</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/vue2-%E5%85%A8%E8%A7%A3/vue-router-%E5%89%8D%E7%AB%AF%E8%B7%AF%E7%94%B1%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%80%9D%E8%B7%AF/">Vue Router -前端路由实现的思路</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/vue2-%E5%85%A8%E8%A7%A3/%E6%95%B0%E6%8D%AE%E5%93%8D%E5%BA%94%E5%BC%8F/">数据响应式</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/vue2-%E5%85%A8%E8%A7%A3/%E6%9E%84%E9%80%A0%E9%80%89%E9%A1%B9/">构造选项</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/vue2-%E5%85%A8%E8%A7%A3/%E6%A8%A1%E6%9D%BF%E6%8C%87%E4%BB%A4%E4%B8%8E%E4%BF%AE%E9%A5%B0%E7%AC%A6-/">模板、指令与修饰符</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/vue2-%E5%85%A8%E8%A7%A3/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3vue%E5%8A%A8%E7%94%BB%E5%8E%9F%E7%90%86/">深入理解Vue动画原理</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/vue2-%E5%85%A8%E8%A7%A3/%E8%A1%A8%E5%8D%95%E4%B8%8Ev-model/">表单与v-model</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/vue2-%E5%85%A8%E8%A7%A3/%E8%B5%B7%E6%89%8B%E5%BC%8F/">起手式</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/vue2-%E5%85%A8%E8%A7%A3/%E8%BF%9B%E9%98%B6%E6%9E%84%E9%80%A0%E5%B1%9E%E6%80%A7/">进阶构造属性</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E5%85%B6%E5%AE%83/">云服务器</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E5%85%B6%E5%AE%83/%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8/">云服务器</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/">前后分离</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" text-eureka  hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/ajax-%E7%9A%84%E5%8E%9F%E7%90%86/">AJAX 的原理</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/ajax%E5%AE%9E%E6%88%98cookiesession/">Ajax实战:Cookie、Session</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/%E5%BC%82%E6%AD%A5%E4%B8%8Epromise/">异步与Promise</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/%E8%B7%A8%E5%9F%9Fcorsjsonp/">跨域、CORS、JSONP</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/%E9%9D%99%E6%80%81%E6%9C%8D%E5%8A%A1%E5%99%A8static-server/">静态服务器Static Server</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">算法与数据结构</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA/">项目构建</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA/webpack%E4%B8%8A/">Webpack(上)</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA/webpack%E4%B8%8B/">Webpack(下)</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
</ul>

</div>







            </div>

        </div>
        <div class="w-full md:w-3/4 lg:w-4/5 pb-8 pt-2 md:pt-8">
            <div class="flex">
                <div class="w-full lg:w-3/4 px-6">
                    <article class="prose">
  <h1 class="mb-4">AJAX 的原理</h1>

  <div
  class="text-tertiary-text not-prose mt-2 flex flex-row flex-wrap items-center"
>
  <div class="me-6 my-2">
    <i class="fas fa-calendar me-1"></i>
    <span
      >2020-10-16</span
    >
  </div>
  <div class="me-6 my-2">
    <i class="fas fa-clock me-1"></i>
    <span>5 min read</span>
  </div>

  

  
</div>


  
  

  <blockquote>
<p>js三座大山之Ajax<br>
<strong>Ajax的全部内容: 用js控制浏览器发请求和收响应</strong></p>
</blockquote>
<p><strong>背景(原理)</strong><br>
<strong>1.Ajax是浏览器推出的一个功能</strong><br>
浏览器可以<strong>发请求，收响应</strong><br>
浏览器在window上加了一个XMLHttpRequest全局函数<br>
用这个构造函数(类)可以构造出一个对象<br>
JS通过它实现<strong>发请求，收响应</strong></p>
<pre><code>typeof window.XMLHttpRequest
'function'
</code></pre>
<p>实际上跟window.Object是一样的。<br>
window.Object用来创建普通对象，window.XMLHttpRequest用来创建XMLRequest对象。<br>
XMLHttpRequest也是一个构造函数，可以构造出一个对象。<br>
<strong>2.准备一个服务器，用来接收请求</strong><br>
使用<a href="https://github.com/lixueqin-4119/nodejs-test/blob/master/server.js">server.js</a>作为我们的服务器<br>
启动node server.js 8888<br>
添加index.html/main.js两个路由<br>
<strong>工具</strong> <a href="https://github.com/fgnass/node-dev">node-dev</a> 是一个node.js开发工具，当文件被修改时会自动重启node进程。</p>
<pre><code>Installation安装:yarn global add node-dev
Usage使用: node-dev src/server.js
</code></pre>
<p>用node-dev代替node方便开发，node-dev修改时会自动保存重启Restarting<br>
node-dev 已经出 bug 没人修理了，不要使用，请直接使用 node 并手动重启。<br>
<strong>添加index.html/main.js两个路由</strong></p>
<pre><code>http://localhost:8888/index.html 注意浏览器路径要一致！

 if (path === '/index.html') { //1.添加index.html
        response.statusCode = 200
        response.setHeader('Content-Type', 'text/html;charset=utf-8')
        response.write(`\n
    &lt;!DOCTYPE html&gt;
    &lt;html&gt;
    &lt;head&gt;
      &lt;title&gt;Ajax&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
      &lt;h1&gt;Ajax demo&lt;/h1&gt;
      &lt;script src=&quot;main.js&quot;&gt;&lt;/script&gt;
    &lt;/body&gt;
    &lt;/html&gt;
    `)
        response.end()
    } else if (path === '/main.js') { //2.添加main.js
        response.statusCode = 200
        response.setHeader('Content-Type', 'text/javascript;charset=utf-8')
        response.write(`console.log('我是js')`)
        response.end()
    } else { ... }
</code></pre>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/437327eb06374dc98624935f7069c386~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<p><strong>模块化</strong><a href="https://editor.csdn.net/md/?articleId=122872618">示例代码</a><br>
把html、css、js单独写到文件里<br>
1.write接收字符串，<a href="https://www.liaoxuefeng.com/wiki/1022910821149312/1023025763380448">把文件变字符串</a></p>
<pre><code>const string = fs.readFileSync('public/index.html') //html,注意不能有空格
response.write(string)
response.write(`fs.readFileSync('public/main.js')`) //js
</code></pre>
<p>对node.js来说文件就是字符串</p>
<p>这个服务器可以用js来控制你访问什么路径。<br>
<strong>注意，这(判断语句)是服务器端的js(node.js),不是ajax.它也可以用java或者php写，跟ajax无关</strong>。</p>
<h3 id="挑战1-加载css"><a href=""></a>挑战1 加载CSS</h3>
<p>以前我们用<code>&lt;link rel=stylesheet href=&quot;1.css&quot;/&gt;</code><br>
今天用AJAX加载css,<strong>4步走</strong></p>
<p><strong>1’不用ajax怎么做？</strong><br>
首先新建style.css写好样式,然后index.html里引入css<code>&lt;link rel=&quot;styleheet&quot; href=&quot;/style.css&quot;&gt;</code>,最后添加路由,代码如下：</p>
<pre><code>else if (path === '/style.css') {
  response.statusCode = 200
  response.setHeader('Content-Type', 'text/css;charset=utf-8')
  response.write(fs.readFileSync('public/style.css'))
  response.end()
}
</code></pre>
<p><strong>2’用ajax怎么做？</strong><br>
在js里请求Ajax<br>
<strong>4步骤</strong><br>
<strong>1.创建HttpRequest对象(全称是XMLHttpRequest)</strong><br>
<strong>2.调用对象的open方法</strong><br>
<strong>3.监听对象的unload &amp; onerror事件(成功/失败)</strong><br>
<strong>4.调用对象的send方法(发送请求)</strong></p>
<p><strong>1.创建HttpRequest对象(全称是XMLHttpRequest)</strong></p>
<pre><code>const request=new XMLHttpRequest()
</code></pre>
<p><strong>2.调用对象的open方法</strong></p>
<pre><code>request.open('GET','./style.css')
</code></pre>
<p>🔍<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/open">mdn XMLHttpRequest open</a><br>
语法xhrReq.open(method, url);
<br>
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/39a569c8ca1246b89584ac1a6588f852~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<p><strong>注意:专业前端只用前面2个! 后面的基本没人会用</strong><br>
method:get/post</p>
<p><strong>3.监听对象的unload &amp; onerror事件(成功/失败)</strong><br>
专业前端会改用onreadystatechange事件<br>
在事件处理函数里操作CSS文件内容<br>
<strong>4.调用对象的send方法(发送请求)</strong><br>
具体代码打开MDN用CRM大法搞定</p>
<pre><code>request.onload = () =&gt; {
    console.log(&quot;成功了&quot;)
}
request.onerror = () =&gt; {
    console.log(&quot;失败了&quot;)
}
request.send()
</code></pre>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6839fa51186b4bb6acb29eb0016ceda6~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<p>拿到内容request.response<br>
添加button请求css，方便查看</p>
<pre><code>getCSS.onclick = () =&gt; {
  const request = new XMLHttpRequest()
  request.open('GET', './style.css')
  request.onload = () =&gt; {
    console.log('request.response' + request.response)
    console.log(&quot;成功了&quot;)
  }
  request.onerror = () =&gt; { console.log(&quot;失败了&quot;) }
  request.send()
}
</code></pre>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/952f4208c5b94d23839c0705ef955456~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<p><strong>有内容后如何生效？</strong><br>
创建style标签，填写style内容，插到头里面</p>
<pre><code>const style = document.createElement('style')
style.innerHTML = request.response
document.head.appendChild(style)
</code></pre>
<h3 id="挑战2-加载js"><a href=""></a>挑战2 加载js</h3>
<p>以前我们用<code>&lt;script src=&quot;2.js&quot;/&gt;&lt;/script&gt;</code><br>
今天用AJAX加载js<br>
1’不用ajax<br>
首先新建2.js写好代码,然后html里引入js<code>&lt;script src=&quot;2.js&quot;&gt;&lt;/script&gt;</code>,最后添加路由,代码如下：</p>
<pre><code>else if(path==='/2.js'){
    response.statusCode = 200
    response.setHeader('Content-Type', 'text/javascript;charset=utf-8')
    response.write(fs.readFileSync('public/2.js'))
    response.end()
  }
</code></pre>
<p><strong>2’用ajax</strong><br>
添加个button请求js,方便查看<code>&lt;button id=&quot;getJS&quot;&gt;请求JS&lt;/button&gt;</code></p>
<pre><code>getJS.onclick = () =&gt; {
  const request = new XMLHttpRequest()
  request.open('GET', './2.js')
  request.onload = () =&gt; {
    //console.log('request.response:' + request.response)
    const script = document.createElement('script')
    script.innerHTML = request.response
    document.body.appendChild(script)
  }
  request.onerror = () =&gt; { console.log(&quot;失败了&quot;) }
  request.send()
}
</code></pre>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/eea1ed16249b49a89f735568b9e565f4~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<p><strong>为什么插入就可以执行？</strong><br>
原理,只要浏览器看到了<code>&lt;script&gt;</code>标签，它就会执行里面的内容，没看到就不会执行。<br>
在学习<strong>DOM操作跨线程</strong>时说过“js引擎与浏览器的关系”。浏览器包括很多部分，其中就包括js引擎、渲染引擎。只有把js标签放到渲染引擎里才会触发。</p>
<h3 id="挑战3-加载html">挑战3 加载html</h3>
<p>以前我们不会加载3.html <a href="https://github.com/lixueqin-4119/js-demo29">示例代码</a></p>
<p>添加个button请求html,方便查看<br>
<strong>步骤</strong><br>
1.新建文件3.html写好要展示的html<br>
2.添加button方便查看<code>&lt;button id=&quot;getHtml&quot;&gt;请求html&lt;/button&gt;</code><br>
添加路由,代码如下：</p>
<pre><code>else if (path === '/3.html') { 
  response.statusCode = 200
  response.setHeader('Content-Type', 'text/html;charset=utf-8')
  response.write(fs.readFileSync('public/3.html'))
  response.end()
} 

getHtml.onclick = () =&gt; {
  const request = new XMLHttpRequest()
  request.open('GET', './3.html')
  request.onload = () =&gt; {
    console.log('request.response:' + request.response)
    const div = document.createElement('div')
    div.innerHTML = request.response
    document.body.appendChild(div)
  }
  request.onerror = () =&gt; { console.log(&quot;失败了&quot;) }
  request.send()
}
</code></pre>
<p><strong>应用场景:</strong>  可以把页面拆成各个不同的部分，当用户点击时再请求这部分，这在以前是做不到的。<br>
Ajax可以做到轻量级的请求。你想请求什么都可以，只要http支持就可以。</p>
<h3 id="onreadystatechange-事件"><a href=""></a>onreadystatechange 事件</h3>
<p><strong>什么时候会触发onerror呢？</strong><br>
假设故意将路径写错成3.htm，这时只会触发404而不是onerror。</p>
<pre><code>else {
  response.statusCode = 404
  response.setHeader('Content-Type', 'text/html;charset=utf-8')
  response.write(`你输入的路径不存在对应的内容`)
  response.end()
}
</code></pre>
<p>因为onerror并没有很好的匹配ajax，因为onerror是先发明的，ajax是后发明的。
onerror一开始是用来检测请求图片失败了，没有料想到会去监听ajax失败。<br>
那这个怎么解决呢？</p>
<p>专业的前端不会使用 onload &amp; onerror事件(太简陋了)，会改用<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/onreadystatechange">onreadystatechange</a>事件。</p>
<p>只要<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/readyState">readyState</a>属性发生变化，就会调用触发相应的处理函数。readyState值如下图所示:<br>
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/67cad00b1a6b48ea9bd1285f4931e134~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<p><strong>助解图</strong><br>
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/290abb77ad754f06ae0b17f7ec3e625b~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<p>将路径故意写错为styl.css,用onreadystatechange改写。<br>
不管结果是成功还是失败都会打印出<strong>下载完成</strong>(1个请求)</p>
<pre><code>getCSS.onclick = () =&gt; {
  const request = new XMLHttpRequest()
  request.open('GET', './styl.css') //readyState=1
  request.onreadystatechange = () =&gt; {
    //下载完成(一个请求完成)，但不知道是成功2xx还是失败4xx 5xx
    console.log(request.readyState) 
    if (request.readyState === 4) {
      console.log(&quot;下载完成&quot;)
      console.log(request.status) //打印http状态码
      if (request.status &gt;= 200 &amp;&amp; request.status &lt; 300) { //当状态码以2开头才算成功
        const style = document.createElement('style')
        style.innerHTML = request.response
        document.head.appendChild(style)
      } else {
        alert('加载css失败')
      }
    }
  }
  request.send() //readyState=2
}
</code></pre>
<p><strong>补充：http状态码以2开头的都表示成功</strong>，一般不用管300多，因为3开头会再次发一个新的请求。<br>
<strong>不管是成功还是失败都会打出下载完成</strong><br>
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2a5223627a4c4cd6bb99d9af313f9824~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<h3 id="挑战4-加载-xml"><a href=""></a>挑战4 加载 XML</h3>
<p><strong>步骤</strong><br>
1.新建文件4.xml写好要展示的<a href="https://developer.mozilla.org/zh-CN/docs/Web/XML/XML_Introduction#xml_.e7.a4.ba.e4.be.8b_2">xml</a></p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;message&gt;
    &lt;warning&gt;
         Hello World
    &lt;/warning&gt;
&lt;/message&gt;
</code></pre>
<p>2.添加button方便查看<code>&lt;button id=&quot;getXML&quot;&gt;请求XML&lt;/button&gt;</code><br>
添加路由,代码如下：</p>
<pre><code>else if (path === '/4.xml') {
  response.statusCode = 200
  response.setHeader('Content-Type', 'text/xml;charset=utf-8')
  response.write(fs.readFileSync('public/4.xml'))
  response.end()
}
</code></pre>
<p>补充：<strong>当new后面没有参数时可以省略()</strong></p>
<pre><code>const request = new XMLHttpRequest()
没有参数时可以省略()
const request = new XMLHttpRequest
</code></pre>
<p><strong>request.responseXML可以直接将字符串变成dom对象</strong><br>
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1200564a69324a36baf66120f5d721f4~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<p><strong>DOM对象不止是用于html,还可以用于xml文档</strong></p>
<pre><code>getXML.onclick = () =&gt; {
  const request = new XMLHttpRequest()
  request.open('GET', './4.xml')
  request.onreadystatechange = () =&gt; {
    if (request.readyState === 4 &amp;&amp; request.status === 200) {
      //console.log(request.responseXML)
      //console.log(request.responseXML)
      const dom = request.responseXML
      const text = dom.getElementsByTagName('warning')[0].textContent
        console.log(text.trim())
    }
  }
  request.send()
}
</code></pre>
<p><strong>注意:<strong>getElementsByTagName得到的是伪数组必须加[0]否则</strong>undefined</strong></p>
<p><strong>Ajax最初就是为了让你使用responseXML，只不过发展2年不到，一个新的语言替代了xml，它就是json。</strong></p>
<h3 id="总结">总结</h3>
<p><strong>HTTP是个框，什么都能往里装</strong><br>
可以装HTML、CSS、JS、XML…<br>
记得设置正确的Content-Type,这是好习惯<br>
只要你知道怎么解析这些内容，就可以使用这些内容<br>
<strong>解析方法</strong><br>
得到css后生成style标签<br>
得到js后生成script标签<br>
得到html之后使用innerHTML和DOM API<br>
得到xml之后使用responseXML和DOM API<br>
不同类型的数据有不同类型的解析办法</p>
<h3 id="什么是json"><a href=""></a>什么是JSON？</h3>
<p><strong>JS对象标记语言JavaScript Object Notation</strong><br>
<strong>JSON是一门语言</strong><br>
跟HTML、CSS、XML、JS一样，是一门独立的语言<br>
<strong>JSON不是编程语言是标记语言</strong><br>
跟HTML、XML、Markdown一样，用来展示数据<br>
<a href="https://www.json.org/json-en.html">中文官网</a><br>
一页纸就说明了JSON的所有语法<br>
你会看铁轨图就会用JSON<br>
例子：<br>
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8bf66166472148b19bfba72320ed3533~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<p>对象的语法是{ }空对象 或者 {“name”:“li”,“age”:18}<br>
<strong>支持的数据类型</strong><br>
<strong>string</strong> 只支持双引号，不支持单引号和无引号<br>
<strong>number</strong> 支持科学记数法<br>
<strong>object</strong><br>
<strong>array</strong><br>
bool true和false<br>
null 没有undefined<br>
就这6种，注意跟JS的七种数据类型区别开来<br>
不支持函数，不支持变量(所以也不支持引用)</p>
<p><strong>JSON抄袭JS，把js糟粕删掉只取了好的部分，好的这部分就是JSON的全部内容。</strong></p>
<h3 id="挑战5-加载json"><a href=""></a>挑战5 加载json</h3>
<p>我们需要加载5.json</p>
<p><strong>步骤</strong><br>
1.新建文件5.json写好要展示的数据</p>
<pre><code>{
    &quot;name&quot;:&quot;李雪芹&quot;,
    &quot;age&quot;:18,
    &quot;xxx&quot;:null
}
</code></pre>
<p>2.添加button方便查看<code>&lt;button id=&quot;getJSON&quot;&gt;请求JSONL&lt;/button&gt;</code><br>
添加路由,代码如下：</p>
<pre><code>else if (path === '/5.json') {
        response.statusCode = 200
        response.setHeader('Content-Type', 'text/json;charset=utf-8')
        response.write(fs.readFileSync('public/5.json'))
        response.end()
    }
</code></pre>
<pre><code>getJSON.onclick = () =&gt; {
    const request = new XMLHttpRequest()
    request.open('GET', './5.json')
    request.onreadystatechange = () =&gt; {
        if (request.readyState === 4 &amp;&amp; request.status == 200) {
            console.log(request.response)
            const object = JSON.parse(request.response)
            console.log(object)
        }
    }
    request.send()
}
</code></pre>
<p><strong>如何把字符串变成js对象？</strong><br>
<strong>JSON.parse()可以把符合JSON语法的字符串变成对应的对象或者是其它东西。</strong><br>
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/689c1ae413304c75abe40f9cafb68d72~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"><br>
ajax把json代替xml作为数据请求，JSON.parse()可以解析它。<br>
我们可以对数据进行任意操作，用处很广泛。<br>
例如，进入网站时会提示 “欢迎，李雪芹”</p>
<pre><code>index.htm
&lt;h1&gt;ajax hello&lt;span id=&quot;myName&quot;&gt;&lt;/span&gt;&lt;/h1&gt;

main.js
getJSON.onclick = () =&gt; {
...
 myName.textContent = object.name
}
</code></pre>
<h3 id="总结-1">总结</h3>
<p>window.JSON是全局对象,它有2个方法。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7a5738dc364e493faadc7017828a5340~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<p><strong>JSON.parse</strong></p>
<p>将符合JSON语法的字符串转化成JS对应类型的数据</p>
<p>JSON字符串 =&gt; JS数据</p>
<p>由于JSON只有6种类型，所以转成的数据也只有6种</p>
<p>如果不符合JSON语法，则直接抛出一个Error对象</p>
<p>一半用try catch捕获错误</p>
<p><strong>JSON.stringify</strong></p>
<p>是JSON.parse的逆运算</p>
<p>JS数据 =&gt; JSON字符串</p>
<p><strong>由于JS的数据类型比JSON多，所以不一定能成功</strong></p>
<p>如果失败就抛出一个Error对象</p>
<p>json不支持函数</p>
<p><strong>经验：使用JSON.parse时一定要try catch!</strong></p>
<pre><code>JSON.parse(`{'name':'lixueqin'}`) //不能用单引号，必须是双引号
Uncaught SyntaxError: Unexpected token ' in JSON at position 1

let object
try{ //把要写的代码放try里
  object=JSON.parse(`{'name':'lixueqin'}`) //成功的话把值赋给object
}catch(error){
  console.log('出错了，错误详情是')
  console.log(error)
  object={'name':'no name'} //失败的话就用默认的值
}
console.log(object)
</code></pre>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/68e06ff6c728492e9f0f4563279d77de~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p>
<p><strong>注意:</strong></p>
<p>如果你把错误捕获了，object={‘name’:‘no name’}执行完后还是会执行console.log(object)的，因为错误被你消化了。</p>
<p>对代码来说，try catch里是没有错误的。</p>
<p>捕获的意思是我要把这个错误遮住，不能被别人看到了。自己把错误偷偷的干掉。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a481720e1b3b4e6eaca499c4bbbf84b0~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<p>不报错，直接把函数忽略了。</p>
<p>因为JSON不支持函数，所以没办法转。</p>
<h3 id="综合应用-加载分页">综合应用 加载分页</h3>
<p>Ajax最典型的应用<strong>加载分页</strong></p>
<p><strong>步骤</strong></p>
<p>1.把数据放到数据库里。</p>
<p>新建目录db，3个文件page1.json、page2.json、page3.json</p>
<p>page1.json内容为[{“id”:1}, … {“id”:10}]</p>
<p>page2.json内容为[{“id”:11}, … {“id”:20}]</p>
<p>page3.json内容为[{“id”:21}, … {“id”:30}]</p>
<p>2.替换</p>
<pre><code>&lt;div&gt;
  {{page1}}
&lt;/div&gt;
</code></pre>
<p>渲染首页时把page1改为page1的内容。</p>
<pre><code>let string = fs.readFileSync('public/index.html').toString()
const page1 = fs.readFileSync('db/page1.json')  //获取内容
string = string.replace('{{page1}}', page1)  //将拿到的数据放到页面里      
</code></pre>
<p><strong>知识点:</strong></p>
<p>1.<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/replace">replace()</a>方法会产生一个新字符串</p>
<p>2.调用.toString()可以强制变string。</p>
<p>当报错时(TypeError: string.replace is not a function)可以用这个方法解决。</p>
<p>总结：这叫做前后端不分离的渲染技术。</p>
<p><strong>示例：我们也可以将id变成li</strong></p>
<p>从数据库里拿到数据，然后拼接字符串.</p>
<pre><code>let string = fs.readFileSync('public/index.html').toString()
  const page1 = fs.readFileSync('db/page1.json')
  //string = string.replace('{{page1}}', page1)
  const array = JSON.parse(page1)
  const result = array.map(item =&gt; `&lt;li&gt;${item.id}&lt;/li&gt;`).join('')
  string = string.replace('{{page1}}', `&lt;ul id=&quot;xxx&quot;&gt;${result}&lt;/ul&gt;`)
</code></pre>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/35389adecdb346438fdd2d0d413906f3~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<h3 id="请求下一页完整代码httpsgithubcomlixueqin-4119js-demo30blobmasterpublicmainjs">请求下一页<a href="https://github.com/lixueqin-4119/js-demo30/blob/master/public/main.js">完整代码</a></h3>
<p>加个按钮请求下一页<code>&lt;button id=&quot;getPage&quot;&gt;请求下一页&lt;/button&gt;</code>，然后添加监听。</p>
<pre><code>getPage.onclick = () =&gt; {
    const request = new XMLHttpRequest()
    request.open('GET', '/page2')
    request.onreadystatechange = () =&gt; {
        if (request.readyState === 4 &amp;&amp; request.status == 200) {
            console.log(request.response)
        }
    }
    request.send()
}
</code></pre>
<p>添加后台响应</p>
<pre><code>else if (path === '/page2') {
  response.statusCode = 200
  response.setHeader('Content-Type', 'text/json;charset=utf-8')
  response.write(fs.readFileSync('db/page2.json'))
  response.end()
} 
</code></pre>
<p>用js把page2放到page1后面</p>
<pre><code>
let n = 1 //值会变化时用let
getPage.onclick = () =&gt; {
  const request = new XMLHttpRequest()
  request.open('GET', `/page${n + 1}`)
  request.onreadystatechange = () =&gt; {
    if (request.readyState === 4 &amp;&amp; request.status == 200) {
      const array = JSON.parse(request.response) //把json字符串变成js数组
      array.forEach(item =&gt; {//将每个元素叫做item
        const li = document.createElement('li')
        li.textContent = item.id
        xxx.appendChild(li) //&lt;ul id=&quot;xxx&quot;&gt;
      });
        n += 1
    }
  }
  request.send()
}
</code></pre>
<p>xxx.appendChild(li)<br>
解析:window.idxxx可以直接idxxx 或者 document.querySelector(’#idxxx’)</p>
<p>添加page3路由代码略</p>

</article>

                    
                    
                    

                    



                    
  <div
    class="-mx-2 mt-4 flex flex-col border-t px-2 pt-4 md:flex-row md:justify-between"
  >
    <div>
      
    </div>
    <div class="mt-4 md:mt-0 md:text-right">
      
        <span class="text-primary-text block font-bold">Next</span>
        <a href="http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/ajax%E5%AE%9E%E6%88%98cookiesession/" class="block">Ajax实战:Cookie、Session</a>
      
    </div>
  </div>


                    



                </div>
                
                <div class="hidden lg:block lg:w-1/4">
                    
                    <div
  class="
    bg-secondary-bg
   prose sticky top-16 z-10 hidden px-6 py-4 lg:block"
>
  <h3>On This Page</h3>
</div>
<div
  class="sticky-toc 
    border-s
   hidden px-6 pb-6 lg:block"
>
  <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#挑战1-加载css"><a href=""></a>挑战1 加载CSS</a></li>
        <li><a href="#挑战2-加载js"><a href=""></a>挑战2 加载js</a></li>
        <li><a href="#挑战3-加载html">挑战3 加载html</a></li>
        <li><a href="#onreadystatechange-事件"><a href=""></a>onreadystatechange 事件</a></li>
        <li><a href="#挑战4-加载-xml"><a href=""></a>挑战4 加载 XML</a></li>
        <li><a href="#总结">总结</a></li>
        <li><a href="#什么是json"><a href=""></a>什么是JSON？</a></li>
        <li><a href="#挑战5-加载json"><a href=""></a>挑战5 加载json</a></li>
        <li><a href="#总结-1">总结</a></li>
        <li><a href="#综合应用-加载分页">综合应用 加载分页</a></li>
        <li><a href="#请求下一页完整代码httpsgithubcomlixueqin-4119js-demo30blobmasterpublicmainjs">请求下一页<a href="https://github.com/lixueqin-4119/js-demo30/blob/master/public/main.js">完整代码</a></a></li>
      </ul>
    </li>
  </ul>
</nav>
</div>
<script>
  window.addEventListener("DOMContentLoaded", () => {
    enableStickyToc();
  });
</script>

                    
                </div>
                
            </div>

        </div>


    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        
        hljs.initHighlightingOnLoad();
        changeSidebarHeight();
        switchDocToc();
    })
</script>









          </div>
        </div>
      
    </main>
    <footer class="pl-scrollbar">
      <div class="mx-auto w-full max-w-screen-xl"><div class="text-center p-6 pin-b">
    <p class="text-sm text-tertiary-text">&copy; 2021 <a href="https://www.wangchucheng.com/">WANG Chucheng</a> and <a href="https://www.ruiqima.com/">MA Ruiqi</a>
 &middot;  Powered by the <a href="https://github.com/wangchucheng/hugo-eureka" class="hover:text-eureka">Eureka</a> theme for <a href="https://gohugo.io" class="hover:text-eureka">Hugo</a></p>
</div></div>
    </footer>
  </body>
</html>
