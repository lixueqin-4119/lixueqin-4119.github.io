<!DOCTYPE html>
<html
  lang="en"
  dir="ltr"
  
><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">


<title>异步与Promise | 目录 | 博客</title>

<meta name="generator" content="Hugo Eureka 0.9.1" />
<link rel="stylesheet" href="http://lixueqin-4119.xyz/css/eureka.min.6a378a23360d238dc3ef4df2f5cd718093f02c10c9c7eb2437c29701cd8d389ab6da5d9f21bdd3afa305fd56c1235017.css" integrity="sha384-ajeKIzYNI43D703y9c1xgJPwLBDJx&#43;skN8KXAc2NOJq22l2fIb3Tr6MF/VbBI1AX">
<script defer src="http://lixueqin-4119.xyz/js/eureka.min.f1639ee98d6cbd85b2b5f034d27320da962002ff83159ed4e01dbc5948c42a1ab26c2d6e74c66e93f5cec4d24dbd166d.js" integrity="sha384-8WOe6Y1svYWytfA00nMg2pYgAv&#43;DFZ7U4B28WUjEKhqybC1udMZuk/XOxNJNvRZt"></script>

<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload"
  href="https://fonts.googleapis.com/css2?family=Lora:wght@400;600;700&family=Noto+Serif+SC:wght@400;600;700&display=swap"
  as="style" onload="this.onload=null;this.rel='stylesheet'">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/styles/base16/solarized-light.min.css"
   media="print"
  onload="this.media='all';this.onload=null" crossorigin>
<script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/highlight.min.js"
   crossorigin></script>
  <script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/dart.min.js"
     crossorigin></script>


<script defer type="text/javascript" src="http://lixueqin-4119.xyz/js/fontawesome.min.7b735802cbde01152678cc4a867f0b4bb0597876e29adfcaf1e5b5e99d39d7af87f348fdfd91c7eaf9ed7dc1eece7c61.js" integrity="sha384-e3NYAsveARUmeMxKhn8LS7BZeHbimt/K8eW16Z0516&#43;H80j9/ZHH6vntfcHuznxh"></script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css"
   integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ"  media="print"
  onload="this.media='all';this.onload=null" crossorigin>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js" 
  integrity="sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY"  crossorigin></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js"
   integrity="sha384-&#43;XBljXPPiv&#43;OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR"  crossorigin></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false },
        { left: "\\(", right: "\\)", display: false },
        { left: "\\[", right: "\\]", display: true }
      ],
    });
  });
</script>


<script defer src="https://cdn.jsdelivr.net/npm/mermaid@8.14.0/dist/mermaid.min.js" 
  integrity="sha384-atOyb0FxAgN9LyAc6PEf9BjgwLISyansgdH8/VXQH8p2o5vfrRgmGIJ2Sg22L0A0"  crossorigin></script>


<link rel="icon" type="image/png" sizes="32x32" href="http://lixueqin-4119.xyz/images/icon_hu64421c6c7700f606f0ad45d807017b09_5843_32x32_fill_box_center_3.png">
<link rel="apple-touch-icon" sizes="180x180" href="http://lixueqin-4119.xyz/images/icon_hu64421c6c7700f606f0ad45d807017b09_5843_180x180_fill_box_center_3.png">

<meta name="description"
  content="面试必考
AJAX(Async JavaScript And XML)
内容:Ajax异步编程在js里的统一解决方案(js异步编程模型) Promise
 什么是异步？什么是同步？ 同步：能直接拿到结果
比如你在医院挂号，拿到号才会离开窗口。
同步任务可能消耗10ms,也可能需要3s
总之不拿到结果你是不会离开的
异步：不能直接拿到结果
比如你在餐厅门口等位，拿到号可以去逛街
什么时候才能真正吃饭呢？
你可以每10min去餐厅问一下(轮询)
你也可以扫码用微信接收通知(回调)
异步通常指&quot;异步加回调&quot;
举例
1.以ajax为例
request.send()之后，并不能直接得到response
不信console.log(request.response)试试
必须等到readState变为4后，浏览器回头调用
request.onreadystatechange函数
我们才能得到request.response
这跟餐厅给你发送微信提醒的过程是类似的
补充：在js中发一个网络请求并得到响应大概要几百ms~1/2s
getJSON.onclick = () =&gt; { ... request.send() console.log(request.response) //不能直接得到response setTimeout(() =&gt; { //2s后得到response console.log(request.response) }, 2000) } 下载完成后浏览器会回调request.onreadystatechange函数 所以上面的代码等价于 request.onreadystatechange = () =&gt; { if (request.readyState === 4 &amp;&amp; request.status == 200) { console.log(request.response) ... } 打印出response后就是3s后  2.回调callback
你写给自己用的函数，不是回调
你写给别人用的函数，就是回调
request.onreadystatechange就是我写给浏览器调用的
意思就是浏览器回头调一下这个函数
「回头」也有「将来」的意思，如「我回头请你吃饭」
举例
1.把函数1给另一个函数2">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
      "@type": "ListItem",
      "position": 1 ,
      "name":"",
      "item":"http://lixueqin-4119.xyz/docs/"},{
      "@type": "ListItem",
      "position": 2 ,
      "name":"目录",
      "item":"http://lixueqin-4119.xyz/docs/example-doc/"},{
      "@type": "ListItem",
      "position": 3 ,
      "name":"前后分离",
      "item":"http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/"},{
      "@type": "ListItem",
      "position": 4 ,
      "name":"异步与Promise",
      "item":"http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/%E5%BC%82%E6%AD%A5%E4%B8%8Epromise/"}]
}
</script>



<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/%E5%BC%82%E6%AD%A5%E4%B8%8Epromise/"
    },
    "headline": "异步与Promise | 目录 | 博客","datePublished": "2020-10-16T00:00:00+00:00",
    "dateModified": "2020-10-16T00:00:00+00:00",
    "wordCount":  593 ,
    "publisher": {
        "@type": "Person",
        "name": "WANG Chucheng",
        "logo": {
            "@type": "ImageObject",
            "url": "http://lixueqin-4119.xyz/images/icon.png"
        }
        },
    "description": "面试必考\nAJAX(Async JavaScript And XML)\n内容:Ajax异步编程在js里的统一解决方案(js异步编程模型) Promise\n 什么是异步？什么是同步？ 同步：能直接拿到结果\n比如你在医院挂号，拿到号才会离开窗口。\n同步任务可能消耗10ms,也可能需要3s\n总之不拿到结果你是不会离开的\n异步：不能直接拿到结果\n比如你在餐厅门口等位，拿到号可以去逛街\n什么时候才能真正吃饭呢？\n你可以每10min去餐厅问一下(轮询)\n你也可以扫码用微信接收通知(回调)\n异步通常指\u0026quot;异步加回调\u0026quot;\n举例\n1.以ajax为例\nrequest.send()之后，并不能直接得到response\n不信console.log(request.response)试试\n必须等到readState变为4后，浏览器回头调用\nrequest.onreadystatechange函数\n我们才能得到request.response\n这跟餐厅给你发送微信提醒的过程是类似的\n补充：在js中发一个网络请求并得到响应大概要几百ms~1\/2s\ngetJSON.onclick = () =\u0026gt; { ... request.send() console.log(request.response) \/\/不能直接得到response setTimeout(() =\u0026gt; { \/\/2s后得到response console.log(request.response) }, 2000) } 下载完成后浏览器会回调request.onreadystatechange函数 所以上面的代码等价于 request.onreadystatechange = () =\u0026gt; { if (request.readyState === 4 \u0026amp;\u0026amp; request.status == 200) { console.log(request.response) ... } 打印出response后就是3s后  2.回调callback\n你写给自己用的函数，不是回调\n你写给别人用的函数，就是回调\nrequest.onreadystatechange就是我写给浏览器调用的\n意思就是浏览器回头调一下这个函数\n「回头」也有「将来」的意思，如「我回头请你吃饭」\n举例\n1.把函数1给另一个函数2"
}
</script><meta property="og:title" content="异步与Promise | 目录 | 博客" />
<meta property="og:type" content="article" />


<meta property="og:image" content="http://lixueqin-4119.xyz/images/icon.png">


<meta property="og:url" content="http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/%E5%BC%82%E6%AD%A5%E4%B8%8Epromise/" />




<meta property="og:description" content="面试必考
AJAX(Async JavaScript And XML)
内容:Ajax异步编程在js里的统一解决方案(js异步编程模型) Promise
 什么是异步？什么是同步？ 同步：能直接拿到结果
比如你在医院挂号，拿到号才会离开窗口。
同步任务可能消耗10ms,也可能需要3s
总之不拿到结果你是不会离开的
异步：不能直接拿到结果
比如你在餐厅门口等位，拿到号可以去逛街
什么时候才能真正吃饭呢？
你可以每10min去餐厅问一下(轮询)
你也可以扫码用微信接收通知(回调)
异步通常指&quot;异步加回调&quot;
举例
1.以ajax为例
request.send()之后，并不能直接得到response
不信console.log(request.response)试试
必须等到readState变为4后，浏览器回头调用
request.onreadystatechange函数
我们才能得到request.response
这跟餐厅给你发送微信提醒的过程是类似的
补充：在js中发一个网络请求并得到响应大概要几百ms~1/2s
getJSON.onclick = () =&gt; { ... request.send() console.log(request.response) //不能直接得到response setTimeout(() =&gt; { //2s后得到response console.log(request.response) }, 2000) } 下载完成后浏览器会回调request.onreadystatechange函数 所以上面的代码等价于 request.onreadystatechange = () =&gt; { if (request.readyState === 4 &amp;&amp; request.status == 200) { console.log(request.response) ... } 打印出response后就是3s后  2.回调callback
你写给自己用的函数，不是回调
你写给别人用的函数，就是回调
request.onreadystatechange就是我写给浏览器调用的
意思就是浏览器回头调一下这个函数
「回头」也有「将来」的意思，如「我回头请你吃饭」
举例
1.把函数1给另一个函数2" />




<meta property="og:locale" content="en" />




<meta property="og:site_name" content="博客" />






<meta property="article:published_time" content="2020-10-16T00:00:00&#43;00:00" />


<meta property="article:modified_time" content="2020-10-16T00:00:00&#43;00:00" />



<meta property="article:section" content="docs" />





  <body class="flex min-h-screen flex-col">
    <header
      class="min-h-16 pl-scrollbar bg-secondary-bg fixed z-50 flex w-full items-center shadow-sm"
    >
      <div class="mx-auto w-full max-w-screen-xl"><script>
    let storageColorScheme = localStorage.getItem("lightDarkMode")
    if (((storageColorScheme == 'Auto' || storageColorScheme == null) && window.matchMedia("(prefers-color-scheme: dark)").matches) || storageColorScheme == "Dark") {
        document.getElementsByTagName('html')[0].classList.add('dark')
    }
</script>
<nav class="flex items-center justify-between flex-wrap px-4 py-4 md:py-0">
    <a href="/" class="me-6 text-primary-text text-xl font-bold">博客</a>
    <button id="navbar-btn" class="md:hidden flex items-center px-3 py-2" aria-label="Open Navbar">
        <i class="fas fa-bars"></i>
    </button>

    <div id="target"
        class="hidden block md:flex md:grow md:justify-between md:items-center w-full md:w-auto text-primary-text z-20">
        <div class="md:flex md:h-16 text-sm md:grow pb-4 md:pb-0 border-b md:border-b-0">
            <a href="/posts/" class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2  border-transparent  me-4">简介</a>
            <a href="/docs/" class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2  selected-menu-item  me-4">文章</a>
            <a href="/#about" class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2  border-transparent  me-4">关于我</a>
        </div>

        <div class="flex">
            <div class="relative pt-4 md:pt-0">
                <div class="cursor-pointer hover:text-eureka" id="lightDarkMode">
                    <i class="fas fa-adjust"></i>
                </div>
                <div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-30" id="is-open">
                </div>
                <div class="absolute flex flex-col start-0 md:start-auto end-auto md:end-0 hidden bg-secondary-bg w-48 rounded py-2 border border-tertiary-bg cursor-pointer z-40"
                    id='lightDarkOptions'>
                    <span class="px-4 py-1 hover:text-eureka" name="Light">Light</span>
                    <span class="px-4 py-1 hover:text-eureka" name="Dark">Dark</span>
                    <span class="px-4 py-1 hover:text-eureka" name="Auto">Auto</span>
                </div>
            </div>
        </div>
    </div>

    <div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-0" id="is-open-mobile">
    </div>

</nav>
<script>
    
    let element = document.getElementById('lightDarkMode')
    if (storageColorScheme == null || storageColorScheme == 'Auto') {
        document.addEventListener('DOMContentLoaded', () => {
            window.matchMedia("(prefers-color-scheme: dark)").addEventListener('change', switchDarkMode)
        })
    } else if (storageColorScheme == "Light") {
        element.firstElementChild.classList.remove('fa-adjust')
        element.firstElementChild.setAttribute("data-icon", 'sun')
        element.firstElementChild.classList.add('fa-sun')
    } else if (storageColorScheme == "Dark") {
        element.firstElementChild.classList.remove('fa-adjust')
        element.firstElementChild.setAttribute("data-icon", 'moon')
        element.firstElementChild.classList.add('fa-moon')
    }

    document.addEventListener('DOMContentLoaded', () => {
        getcolorscheme();
        switchBurger();
    });
</script>
</div>
    </header>
    <main class="grow pt-16">
        <div class="pl-scrollbar">
          <div class="mx-auto w-full max-w-screen-xl lg:px-4 xl:px-8">


<div class="lg:pt-12">
    <div class="flex flex-col md:flex-row bg-secondary-bg rounded">
        <div class="md:w-1/4 lg:w-1/5 border-e">
            <div class="sticky top-16 pt-6">
                















<div id="sidebar-title" class="md:hidden mx-4 px-2 pt-4 pb-2 md:border-b text-tertiary-text md:text-primary-text">
    <span class="font-semibold">Table of Contents</span>
    <i class='fas fa-caret-right ms-1'></i>
</div>

<div id="sidebar-toc"
    class="hidden md:block overflow-y-auto mx-6 md:mx-0 pe-6 pt-2 md:max-h-doc-sidebar bg-primary-bg md:bg-transparent">
    <div class="flex flex-wrap ms-4 -me-2 p-2 bg-secondary-bg md:bg-primary-bg rounded">
        <a class=" hover:text-eureka"
            href="http://lixueqin-4119.xyz/docs/example-doc/">目录</a>
        
        
        


    </div>
    
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/nested-chapter/">【Git入门】</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/nested-chapter/%E7%94%A8hugo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/">用hugo搭建个人博客</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/nested-chapter/git%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93-github-/">Git远程仓库 -GitHub</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/nested-chapter/%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%85%A5%E9%97%A8/">命令行入门</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/nested-chapter/%E6%9C%AC%E5%9C%B0%E4%BB%93%E5%BA%93/">本地仓库</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/html%E5%85%A8%E8%A7%A3/">【HTML全解】</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/html%E5%85%A8%E8%A7%A3/html%E6%A0%87%E7%AD%BE/">HTML标签</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/html%E5%85%A8%E8%A7%A3/html%E6%A6%82%E8%A7%88/">HTML概览</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/html%E5%85%A8%E8%A7%A3/html%E9%87%8D%E7%82%B9%E6%A0%87%E7%AD%BE/">HTML重点标签</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/html%E5%85%A8%E8%A7%A3/%E6%89%8B%E6%9C%BA%E9%A2%84%E8%A7%88-%E8%B0%83%E8%AF%95/">手机预览 &amp; 调试</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/css%E5%85%A8%E8%A7%A3/">CSS全解</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/css%E5%85%A8%E8%A7%A3/css%E5%8A%A8%E7%94%BB/">css动画</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/css%E5%85%A8%E8%A7%A3/css%E5%9F%BA%E7%A1%80/">css基础</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/css%E5%85%A8%E8%A7%A3/css%E5%AE%9A%E4%BD%8D/">css定位</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/css%E5%85%A8%E8%A7%A3/css%E5%B8%83%E5%B1%80/">css布局</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/http%E5%85%A8%E8%A7%A3/">HTTP全解</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/http%E5%85%A8%E8%A7%A3/http-%E7%8A%B6%E6%80%81%E7%A0%81/">HTTP 状态码</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/http%E5%85%A8%E8%A7%A3/url-%E6%98%AF%E4%BB%80%E4%B9%88/">URL 是什么</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/http%E5%85%A8%E8%A7%A3/%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94-node.js-server/">请求和响应 &amp; Node.js Server</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/">JS全解</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/javascript-%E7%9A%84%E8%AF%9E%E7%94%9F/">JavaScript 的诞生</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/js%E5%87%BD%E6%95%B0/">JS函数</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/js%E5%AF%B9%E8%B1%A1/">JS对象</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/js%E5%AF%B9%E8%B1%A1%E5%88%86%E7%B1%BB/">JS对象分类</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/js%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/">JS数据类型</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/js%E6%95%B0%E7%BB%84/">JS数组</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/js%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">JS正则表达式</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/js%E8%8E%B7%E5%8F%96%E5%B1%8F%E5%B9%95%E5%AE%BD%E9%AB%98/">js获取屏幕宽高</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/js%E8%AF%AD%E6%B3%95/">JS语法</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E5%85%A8%E8%A7%A3/js%E8%BF%90%E7%AE%97%E7%AC%A6/">JS运算符</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E7%BC%96%E7%A8%8B%E6%8E%A5%E5%8F%A3/">JS编程接口</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E7%BC%96%E7%A8%8B%E6%8E%A5%E5%8F%A3/dom-%E7%BC%96%E7%A8%8B/">DOM 编程</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E7%BC%96%E7%A8%8B%E6%8E%A5%E5%8F%A3/dom%E4%BA%8B%E4%BB%B6%E4%B8%8E%E4%BA%8B%E4%BB%B6%E5%A7%94%E6%89%98/">DOM事件与事件委托</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E7%BC%96%E7%A8%8B%E6%8E%A5%E5%8F%A3/-jquery-%E4%B8%AD%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8A/">jQuery 中的设计模式(上)</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E7%BC%96%E7%A8%8B%E6%8E%A5%E5%8F%A3/jquery-%E4%B8%AD%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8B/">jQuery 中的设计模式(下)</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E7%BC%96%E7%A8%8B%E6%8E%A5%E5%8F%A3/%E6%89%8B%E5%86%99dom%E5%BA%931/">手写DOM库(1)</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E8%BF%9B%E9%98%B6/">JS进阶</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E8%BF%9B%E9%98%B6/mvc%E4%B8%8A/">MVC(上)</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/js%E8%BF%9B%E9%98%B6/-mvc%E4%B8%8B-/">MVC(下)</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/react-%E5%85%A8%E8%A7%A3/">React全解</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/react-%E5%85%A8%E8%A7%A3/class-%E7%BB%84%E4%BB%B6%E8%AF%A6%E8%A7%A3/">Class 组件详解</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/react-%E5%85%A8%E8%A7%A3/hooks-%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90/">Hooks 原理解析</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/react-%E5%85%A8%E8%A7%A3/hooks-%E5%90%84%E4%B8%AA%E5%87%BB%E7%A0%B4/">Hooks 各个击破</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/react-%E5%85%A8%E8%A7%A3/react-%E7%B1%BB%E7%BB%84%E4%BB%B6%E5%92%8C%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6/">React 类组件和函数组件</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/react-%E5%85%A8%E8%A7%A3/react%E8%B5%B7%E6%89%8B%E5%BC%8F/">React起手式</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/react-%E5%85%A8%E8%A7%A3/%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6/">函数组件</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/react-%E5%85%A8%E8%A7%A3/%E6%89%8B%E5%86%99-redux/">手写 Redux</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/vue2-%E5%85%A8%E8%A7%A3/">Vue2 全解</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/vue2-%E5%85%A8%E8%A7%A3/computed-%E5%92%8C-watch/">computed 和 watch</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/vue2-%E5%85%A8%E8%A7%A3/vue-router-%E5%89%8D%E7%AB%AF%E8%B7%AF%E7%94%B1%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%80%9D%E8%B7%AF/">Vue Router -前端路由实现的思路</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/vue2-%E5%85%A8%E8%A7%A3/%E6%95%B0%E6%8D%AE%E5%93%8D%E5%BA%94%E5%BC%8F/">数据响应式</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/vue2-%E5%85%A8%E8%A7%A3/%E6%9E%84%E9%80%A0%E9%80%89%E9%A1%B9/">构造选项</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/vue2-%E5%85%A8%E8%A7%A3/%E6%A8%A1%E6%9D%BF%E6%8C%87%E4%BB%A4%E4%B8%8E%E4%BF%AE%E9%A5%B0%E7%AC%A6-/">模板、指令与修饰符</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/vue2-%E5%85%A8%E8%A7%A3/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3vue%E5%8A%A8%E7%94%BB%E5%8E%9F%E7%90%86/">深入理解Vue动画原理</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/vue2-%E5%85%A8%E8%A7%A3/%E8%A1%A8%E5%8D%95%E4%B8%8Ev-model/">表单与v-model</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/vue2-%E5%85%A8%E8%A7%A3/%E8%B5%B7%E6%89%8B%E5%BC%8F/">起手式</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/vue2-%E5%85%A8%E8%A7%A3/%E8%BF%9B%E9%98%B6%E6%9E%84%E9%80%A0%E5%B1%9E%E6%80%A7/">进阶构造属性</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E5%85%B6%E5%AE%83/">云服务器</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E5%85%B6%E5%AE%83/%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8/">云服务器</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/">前后分离</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/ajax-%E7%9A%84%E5%8E%9F%E7%90%86/">AJAX 的原理</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/ajax%E5%AE%9E%E6%88%98cookiesession/">Ajax实战:Cookie、Session</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" text-eureka  hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/%E5%BC%82%E6%AD%A5%E4%B8%8Epromise/">异步与Promise</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/%E8%B7%A8%E5%9F%9Fcorsjsonp/">跨域、CORS、JSONP</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/%E9%9D%99%E6%80%81%E6%9C%8D%E5%8A%A1%E5%99%A8static-server/">静态服务器Static Server</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">算法与数据结构</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA/">项目构建</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA/webpack%E4%B8%8A/">Webpack(上)</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="http://lixueqin-4119.xyz/docs/example-doc/%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA/webpack%E4%B8%8B/">Webpack(下)</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
</ul>

</div>







            </div>

        </div>
        <div class="w-full md:w-3/4 lg:w-4/5 pb-8 pt-2 md:pt-8">
            <div class="flex">
                <div class="w-full lg:w-3/4 px-6">
                    <article class="prose">
  <h1 class="mb-4">异步与Promise</h1>

  <div
  class="text-tertiary-text not-prose mt-2 flex flex-row flex-wrap items-center"
>
  <div class="me-6 my-2">
    <i class="fas fa-calendar me-1"></i>
    <span
      >2020-10-16</span
    >
  </div>
  <div class="me-6 my-2">
    <i class="fas fa-clock me-1"></i>
    <span>3 min read</span>
  </div>

  

  
</div>


  
  

  <blockquote>
<p>面试必考</p>
<p>AJAX(Async JavaScript And XML)</p>
<p>内容:Ajax异步编程在js里的统一解决方案(js异步编程模型) <strong>Promise</strong></p>
</blockquote>
<h3 id="什么是异步什么是同步">什么是异步？什么是同步？</h3>
<p><strong>同步：能直接拿到结果</strong><br>
比如你在医院挂号，拿到号才会离开窗口。<br>
同步任务可能消耗10ms,也可能需要3s<br>
总之不拿到结果你是不会离开的</p>
<p><strong>异步：不能直接拿到结果</strong><br>
比如你在餐厅门口等位，拿到号可以去逛街<br>
什么时候才能真正吃饭呢？<br>
你可以每10min去餐厅问一下(轮询)<br>
你也可以扫码用微信接收通知(回调)<br>
异步通常指&quot;异步加回调&quot;<br>
<strong>举例</strong><br>
<strong>1.以ajax为例</strong><br>
request.send()之后，并不能直接得到response<br>
不信console.log(request.response)试试<br>
必须等到readState变为4后，<strong>浏览器回头调用</strong><br>
request.onreadystatechange函数<br>
我们才能得到request.response<br>
这跟餐厅给你发送微信提醒的过程是类似的</p>
<p><strong>补充：在js中发一个网络请求并得到响应大概要几百ms~1/2s</strong></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8c5f8d86d4b44ecfba91713d146c1099~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<pre><code>getJSON.onclick = () =&gt; {
  ...
  request.send()
  console.log(request.response) //不能直接得到response
  setTimeout(() =&gt; { //2s后得到response
    console.log(request.response)
  }, 2000)
}
下载完成后浏览器会回调request.onreadystatechange函数
所以上面的代码等价于
 request.onreadystatechange = () =&gt; {
   if (request.readyState === 4 &amp;&amp; request.status == 200) {
       console.log(request.response)
       ...
   }
打印出response后就是3s后
</code></pre>
<p><strong>2.回调callback</strong><br>
你写给自己用的函数，不是回调<br>
<strong>你写给别人用的函数，就是回调</strong><br>
request.onreadystatechange就是<strong>我写给浏览器调用</strong>的<br>
意思就是浏览器回头调一下这个函数<br>
「回头」也有「将来」的意思，如「我回头请你吃饭」<br>
<strong>举例</strong><br>
<strong>1.把函数1给另一个函数2</strong></p>
<pre><code>function f1(){}
function f2(fn){
  fn()
}
f2(f1)
</code></pre>
<p>我调用f1没有？没有<br>
我把f1传给f2了没有？传了<br>
f2调用f1了没有？调了<br>
那么f1是不是我写给f2调用的函数？是，所以f1是回调<br>
没有调用、传给别人了、别人调用了<br>
<strong>补充</strong></p>
<pre><code>//request.setCallback(onreadystatechange)
request.onreadystatechange
</code></pre>
<p>是不是参数这个问题并不大，直接写一样的效果<br>
不过一般不推荐放到对象上，最好作为参数传给它，防止别人不知道</p>
<p><strong>抬杠1，如果我传给f2的参数不是函数呢？</strong><br>
会报错:fn不是一个函数。看到报错你不就知错了<br>
<strong>抬杠2</strong></p>
<pre><code>function f1(x){
  console,log(x)
}
function f2(fn){
  fn('你好')
}
f2(f1)
</code></pre>
<p>f1怎么会有一个x参数<br>
fn(&lsquo;你好&rsquo;)中的fn就是f1对吧<br>
fn(&lsquo;你好&rsquo;)中的&rsquo;你好&rsquo;会被赋值给参数x对吧<br>
所以x就是&rsquo;你好&rsquo;。x表示第1个参数而已</p>
<h3 id="异步和回调的关系">异步和回调的关系</h3>
<p><strong>回调就是我把一个函数传给你 或者传到全局函数request上</strong><br>
<strong>关联</strong><br>
异步任务需要在得到结果时通知js来拿结果<br>
怎么通知呢？<br>
可以让js留一个函数地址(电话号码)给浏览器<br>
异步任务完成时浏览器调用该函数地址即可(拨打电话)<br>
同时把结果作为参数传给该函数(电话里说可以来吃了)<br>
这个函数是我写给浏览器调用的，所以是回调函数<br>
<strong>区别</strong><br>
异步任务常常用到回调函数来通知结果，但不一定非要用回调。也可以用轮循<br>
回调函数也不一定只用在异步任务里，也可以用到同步任务里<br>
<code>array.forEach(n=&gt;console.log(n))</code>就是同步回调<br>
<strong>array里有多少个元素forEach就会调用函数n多少次</strong></p>
<h3 id="判断同步异步">判断同步异步</h3>
<p><strong>怎么区分一个函数是同步还是异步？</strong><br>
根据特征或文档<br>
<strong>如果一个函数的返回值处于这3个东西内部，那么这个函数就是异步函数</strong><br>
setTimeout<br>
Ajax(即XMLHttpRequest)<br>
AddEventListener<br>
等下，我听说Ajax可以设置为同步的<br>
傻X前端才把Ajax设置为同步的，这样会使请求期间页面卡住。</p>
<p><strong>例子:异步1个结果的处理</strong><br>
1s后返回1～6的随机数</p>
<pre><code>function 摇骰子(){ 
  setTimeout(()=&gt;{ 
    return parseInt(Math.random() * 6 ) + 1 
  },1000)
  //return undefined
}

const n=摇骰子()
console.log(n) //undefined
</code></pre>
<p>摇骰子()没有写return,那就是return undefined<br>
箭头函数里有return，返回真正的结果<br>
<strong>注意这2个return属于不同的函数</strong><br>
所以这是一个异步函数/任务</p>
<p><strong>那怎么才能拿到异步结果(1～6的随机数)？</strong><br>
可以用回调。写个函数，然后把函数地址给它</p>
<pre><code>function f1(x){console.log(x)}
摇骰子(f1)
</code></pre>
<p>然后我要求<strong>摇骰子函数</strong>得到结果后<strong>把结果作为参数</strong>传给f1</p>
<pre><code>function 摇骰子(fn){ 
  setTimeout(()=&gt;{ 
    fn(parseInt(Math.random() * 6 ) + 1) //得到结果后传给fn
  },1000)
}
</code></pre>
<p>将结果传给fn，这时候就能输出结果了。</p>
<p>简化为箭头函数。f1声明后只用了一次，所以可以删掉f1<br>
<strong>优化技巧：</strong>  函数声明后只用了一次时，可以简化为匿名函数</p>
<pre><code>function f1(x){console.log(x)}
摇骰子(f1)
改为
摇骰子(x=&gt;{
  console.log(x)
})
再简化为
摇骰子(console.log)
</code></pre>
<p><strong>如果参数个数不一致就不能这样简化，有个面试题</strong></p>
<pre><code>摇骰子(x,y=&gt;{
  console.log(x)
})
</code></pre>
<p><strong>面试题</strong></p>
<pre><code>const array=['1','2','3'].map(parseInt)
console.log(array)
输出结果:[1, NaN, NaN]
还原
const array=['1','2','3'].map((item,i,arr)=&gt;{
  return parseInt(item,i,arr)
  //parseInt('1',0,arr)=&gt;1
  //parseInt('2',1,arr)=&gt;NAN 一进制没有2所以得到NAN
  //parseInt('3',2,arr)=&gt;NAN 二进制没有3所以得到NAN
})
console.log(array)
输出结果:[1, NaN, NaN]
</code></pre>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/map#parameters">map接收3个参数</a><br>
把2作为1进制数进行解析，2进制数只有0和1，1进制数只有0，10进制只有0～9。因为一进制没有2所以得到的结果不是一个数字NAN。</p>
<p>正确简化</p>
<pre><code>const array=['1','2','3'].map((item,i,arr)=&gt;{
  return parseInt(item)
})
console.log(array)
输出结果:[1, 2, 3]
简写
const array=['1','2','3'].map((item=&gt;parseInt(item))
console.log(array)
</code></pre>
<p><strong>总结</strong><br>
异步任务不能拿到结果，于是我们传一个回调给异步任务<br>
异步任务完成时调用回调，调用的时候把结果作为参数<br>
异步为什么会用到回调？为了拿到不能直接拿到的结果，必须用回调/轮询</p>
<h3 id="promise的用法httpsdevelopermozillaorgzh-cndocswebjavascriptreferenceglobal_objectspromise"><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise的用法</a></h3>
<p><strong>Promise是前端解决异步问题的统一方案，异步2个结果(成功、失败)的处理</strong><br>
<strong>如果异步任务有2个结果成功和失败，怎么办？</strong><br>
方法1:回调接受两个参数(node.js就是用的这个方案,接收两个参数)</p>
<pre><code>fs.readFile('./1.txt',(error,data)=&gt;{//2个参数:失败的错误，成功的结果
  if(error){console.log('失败'); return}
  console.log(data.toString()) //成功
)
</code></pre>
<p>方法2:搞两个回调</p>
<pre><code>ajax('Get','./1.json',data=&gt;{},error=&gt;{})
//前面函数是成功回调，后面函数是失败回调
或者
ajax('Get','./1.json',{
  success:()=&gt;{},fail:()=&gt;{}
})
//接受一个对象，对象有两个 key 表示成功和失败
</code></pre>
<p>不管方法1还是方法2都有问题，有3个缺点(<strong>回调的3个问题</strong>)<br>
1.不规范没有成文的规定。名称五花八门,有人用success+error,有人用success+fail或者done+fail<br>
2.容易出现<strong>回调地狱</strong>，代码变的看不懂<br>
3.很难进行<strong>错误处理</strong><br>
回调地狱举例</p>
<pre><code>getUser(user=&gt;{
  getGroups(user,(groups)=&gt;{
    groups.forEach((g)=&gt;{
      g.filter(x=&gt;x.ownerId===user.id).forEach(x=&gt;console.log(x))
    })
  })
})
这还只是四层回调，你能想象20层回调吗？
</code></pre>
<p><strong>有什么办法能解决这3个问题？用promise</strong><br>
规范回调的名字或顺序<br>
拒绝回调地狱，让代码可读性更强<br>
很方便地捕获错误</p>
<p>promise思想是在1976年提出的，后来被前端抄袭的。</p>
<p>promise是什么？</p>
<p>1976年的一种设计模式(写得好的代码取了个名)</p>
<p>以ajax的封装为例，解释promise的用法</p>
<p>示例：写一个回调的封装</p>
<pre><code>//1.ajax的定义
ajax=(method,url,options)=&gt;{
  const {success,fail}=options //析构赋值，从options里拿到success和fail这2个回调函数
  const request=new XMLHttpRequest() //全局变量request
  request.open(method,url)
  request.onreadystatechange = () =&gt; {
    if (request.readyState === 4) {
    //成功就调用success,失败就调用fail
      if(request.status &lt; 400){
      //一般来说不会出现300的，300不应该出现在这里，300会再发一个请求
        success.call(null,request.response)
      }else if(request.status &gt;= 400){
        fail.call(null,request,request.status)
      }
    }
  }    
    request.send()  
}
//2.ajax的使用
ajax('Get','/xxx',{
  success(response){},fail:(request,status)=&gt;{}
  //ES6语法：左边是function缩写，右边是箭头函数
})
</code></pre>
<p><strong>ES 6语法：析构赋值</strong></p>
<pre><code>const {success,fail}=options //析构赋值，从options里拿到success和fail这2个回调函数
  //等价于
  //const success=options.success
  //const fail=options.fail
</code></pre>
<p>Promise说这代码太傻了，我们改成promise写法</p>
<pre><code>ajax('Get','/xxx',{
  success(response){},fail:(request,status)=&gt;{}
})
//上面用到了两个回调，还使用了success和fail.
//改成promise写法
ajax('Get','/xxx').then((response)=&gt;{},(request)=&gt;{})
</code></pre>
<p>虽然也是回调，但是不需要记success和fail了</p>
<p>then的第1个参数就是success,第2个参数就是fail</p>
<p><strong>promise规定了成功失败都只能返回一个参数</strong></p>
<p><strong>ajax()返回了个啥？</strong></p>
<p>返回了一个含有.then()方法的对象</p>
<p><strong>那如何得到这个含有.then()的对象呢？</strong></p>
<p>那就要改造ajax的源码了</p>
<pre><code>ajax=(method,url,options)=&gt;{
  return new Promise((resolve,reject)=&gt;{ //1处
    const {success,fail}=options 
    const request=new XMLHttpRequest()
    request.open(method,url)
    request.onreadystatechange = () =&gt; {
      if (request.readyState === 4) {
        if(request.status &lt; 400){
          resolve.call(null,request.response) //2处
        }else if(request.status &gt;= 400){
          reject.call(null,request,request)   //3处
        }
      }
    }    
      request.send()  
  })
}
</code></pre>
<p>符合promise规范的ajax调用，让回调的异步函数变成promise的异步函数</p>
<p><strong>步骤</strong></p>
<p><strong>第1步(定义时)，</strong>  加上return new Promise((resolve,reject)=&gt;{&hellip;})<br>
任务成功调resolve(result)，失败调reject(error)<br>
resolve和reject会再去调用成功和失败函数</p>
<p><strong>第2步(使用时)，</strong>  使用.then(success,fail)传入成功和失败函数</p>
<p><strong>如何使用Promise?</strong></p>
<p>背下来5个词<code>return new promise((resolve,reject)=&gt;{...}</code></p>
<h3 id="总结">总结</h3>
<p><strong>背下来：</strong></p>
<pre><code>return new promise((resolve,reject)=&gt;{成功时调用resolve，失败时调用reject}
//return 构造函数(参数)
</code></pre>
<p><strong>关于异步</strong></p>
<p>1.如果 JS 不能直接拿到一个函数的结果，可以先去执行别的代码，等结果到了再取结果，这就是异步<br>
2.异步的结果可以通过轮询获取，轮询就是定时去询问结果拿到了没有<br>
3.异步的结果可以通过回调获取，一般来说结果会被作为回调的第一个参数<br>
4.异步的好处是可以把用来等待的时间拿去做别的事情\</p>
<p><strong>关于回调</strong></p>
<p>1.满足某些条件的函数才被称为回调，比如我写一个函数 A，传给另一个函数 B 调用，那么函数 A 就是回调<br>
2.回调可以用于同步任务，不一定非要用于异步任务<br>
3.有的时候回调还可以传给一个对象，如 request.onreadystatechange，等待浏览器来调用</p>
<p><strong>关于Promise</strong></p>
<p>1.Promise不是前端发明的，是目前前端解决异步问题的统一方案。<br>
2.window.Promise 是一个全局函数，可以用来构造 Promise 对象<br>
3.使用return new Promise((resolve, reject)=&gt; {})就可以构造一个Promise对象<br>
构造出来的Promise对象含有一个 .then()函数属性</p>
<p><strong>补充：注意Promise不可取消。</strong></p>
<p>为了解决取消promise这个问题,axios自己想了个办法就是用CancleToken。</p>
<p>原理就是将请求编号，假设发了10个promise，其中9个不要了。就把id为1～9的promise对应的ajax请求终止。promise还是做，只不过ajax不要了。axios取消的不是promise而是请求。<code>axios.CancleToken</code></p>
<p><strong>关于return new Promise((resolve, reject)=&gt;{&hellip;})中的resolve和reject</strong></p>
<p>1.resolve 和 reject 可以改成任何其他名字，不影响使用，但一般就叫这两个名字。<br>
2.任务成功的时候调用resolve，失败的时候调用reject<br>
3.resolve和reject都只接收一个数据，而且this是空，不应该用this<br>
4.resolve和reject并不是 .then(success, fail)里面的success和fail，resolve会去调用 success，reject会去调用fail</p>
<p><strong>我们封装的ajax的缺点</strong></p>
<p>1.post无法上传数据 <code>request.send(这里可以上传数据)</code></p>
<p>2.不能设置请求头 <code>request.setRequestHeader(key,value)</code></p>
<p><strong>怎么解决呢？</strong></p>
<p><strong>1.使用axios (推荐)</strong></p>
<p>2.使用<a href="https://www.jquery123.com/jQuery.ajax/">jQuery.ajax</a>
我们需要掌握jQuery.ajax吗？不用，写篇博客罗列下功能，就可以忘掉jQuery了</p>
<p>3.自己花时间把ajax写到完美</p>
<h3 id="axios库">axios库</h3>
<p><a href="http://www.axios-js.com/zh-cn/docs/">中文文档</a> 、<a href="https://kapeli.com/cheat_sheets/Axios.docset/Contents/Resources/Documents/index">英文原文</a></p>
<blockquote>
<p>Axios 是一个基于 promise 的 HTTP 库，可以用在浏览器和 node.js 中。<br>
目前最新的Ajax库，Vue、React都在用它。<br>
这个库比jQuery逼格高，<strong>现在专业前端都在用axios</strong>，它抄袭了jQuery的封装思路。<br>
推荐通过写博客来学习一个库<a href="https://juejin.cn/post/7063572834143961125">axios速查表</a></p>
</blockquote>
<p>代码示例</p>
<pre><code>axios.get('/5.json')
  .then(response=&gt;
    console.log(response)
)
</code></pre>
<p><strong>axios</strong></p>
<p>这是一个专门用于操作 AJAX 的库<br>
axios.get(&rsquo;/xxx&rsquo;) 返回一个 Promise 对象<br>
axios.get(&rsquo;/xxx&rsquo;).then(s, f) 在请求成功的时候调用 s，失败的使用调用 f</p>
<p><strong>axios高级用法</strong></p>
<p><strong>1.JSON自动处理</strong><br>
axios如何发现响应的Content-Type是json<br>
就会自动调用JSON.parse<br>
所以说正确设置Content-Type是好习惯</p>
<p><strong>2.请求拦截器</strong></p>
<blockquote>
<p>你可以在所有请求里加些东西，比如加查询参数</p>
</blockquote>
<p>只要在这个函数里对config做一些修改，那你发的请求就会全部被你自己篡改。<br>
比如说，我们要在请求里统一加个参数，不管这个请求是怎样的都要加一个参数。<br>
那么就可以加个拦截器。</p>
<pre><code>// Add a request interceptor
axios.interceptors.request.use(function (config) {
    // Do something before request is sent
    return config;
  }, function (error) {
    // Do something with request error
    return Promise.reject(error);
  });
</code></pre>
<p><strong>3.响应拦截器</strong></p>
<blockquote>
<p>你可以在所有响应里加些东西，甚至改内容</p>
</blockquote>
<p>function(response){ return response;}得到原始响应数据。如果你对数据不满意，可以对它进行修改。这样你就可以对它进行一些测试。</p>
<pre><code>// Add a response interceptor
axios.interceptors.response.use(function (response) {
    // Do something with response data
    return response;
  }, function (error) {
    // Do something with response error
    return Promise.reject(error);
  });
</code></pre>
<p><strong>4.可以生成不同实例(对象)</strong><br>
不同实例可以设置不同的配置，用于复杂场景</p>
<p>instance就是axios的复制品</p>
<pre><code>var instance = axios.create({
  baseURL: 'https://some-domain.com/api/',
  timeout: 1000,
  headers: {'X-Custom-Header': 'foobar'}
});
</code></pre>
<p><strong>封装！封装！封装！</strong><br>
初级程序员学习API(包括Vue/React的API)<br>
中级程序员学习如何封装<br>
高级程序员造轮子</p>
<p><strong>如何使用Axios? 设置下引用即可使用</strong></p>
<p>打开<a href="https://www.bootcdn.cn/">BootCDN</a>搜索axios-&gt; 选择axios.min.js，点击复制<code>&lt;script&gt;</code>标签</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/37ff93bdfd44420db6a5146c823e16fa~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<p><a href="http://js.jirengu.com/siwudecedi/1/edit?html,output">查看示例</a><br>
console.log(axios)控制台打印出了函数，说明axios存在，这样就引用成功了(引用脚本)。</p>
<p>axios.get(&rsquo;/xxx&rsquo;)请求发送成功了(由于没写内容所以是404)</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1302848a6351423b89d466f9d39826ba~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<p><strong>面试题</strong></p>
<p>为什么我们要用promise啊，能不能讲讲原因？</p>
<p>思路:promise能解决回调的3个问题</p>
<p>1.规范回调的名字或顺序</p>
<p>2.拒绝回调地狱，让代码可读性更强</p>
<p>3.很方便地捕获错误</p>

</article>

                    
                    
                    

                    



                    
  <div
    class="-mx-2 mt-4 flex flex-col border-t px-2 pt-4 md:flex-row md:justify-between"
  >
    <div>
      
        <span class="text-primary-text block font-bold"
          >Previous</span
        >
        <a href="http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/ajax%E5%AE%9E%E6%88%98cookiesession/" class="block">Ajax实战:Cookie、Session</a>
      
    </div>
    <div class="mt-4 md:mt-0 md:text-right">
      
        <span class="text-primary-text block font-bold">Next</span>
        <a href="http://lixueqin-4119.xyz/docs/example-doc/%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/%E8%B7%A8%E5%9F%9Fcorsjsonp/" class="block">跨域、CORS、JSONP</a>
      
    </div>
  </div>


                    



                </div>
                
                <div class="hidden lg:block lg:w-1/4">
                    
                    <div
  class="
    bg-secondary-bg
   prose sticky top-16 z-10 hidden px-6 py-4 lg:block"
>
  <h3>On This Page</h3>
</div>
<div
  class="sticky-toc 
    border-s
   hidden px-6 pb-6 lg:block"
>
  <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#什么是异步什么是同步">什么是异步？什么是同步？</a></li>
        <li><a href="#异步和回调的关系">异步和回调的关系</a></li>
        <li><a href="#判断同步异步">判断同步异步</a></li>
        <li><a href="#promise的用法httpsdevelopermozillaorgzh-cndocswebjavascriptreferenceglobal_objectspromise"><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise的用法</a></a></li>
        <li><a href="#总结">总结</a></li>
        <li><a href="#axios库">axios库</a></li>
      </ul>
    </li>
  </ul>
</nav>
</div>
<script>
  window.addEventListener("DOMContentLoaded", () => {
    enableStickyToc();
  });
</script>

                    
                </div>
                
            </div>

        </div>


    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        
        hljs.initHighlightingOnLoad();
        changeSidebarHeight();
        switchDocToc();
    })
</script>









          </div>
        </div>
      
    </main>
    <footer class="pl-scrollbar">
      <div class="mx-auto w-full max-w-screen-xl"><div class="text-center p-6 pin-b">
    <p class="text-sm text-tertiary-text">&copy; 2021 <a href="https://www.wangchucheng.com/">WANG Chucheng</a> and <a href="https://www.ruiqima.com/">MA Ruiqi</a>
 &middot;  Powered by the <a href="https://github.com/wangchucheng/hugo-eureka" class="hover:text-eureka">Eureka</a> theme for <a href="https://gohugo.io" class="hover:text-eureka">Hugo</a></p>
</div></div>
    </footer>
  </body>
</html>
